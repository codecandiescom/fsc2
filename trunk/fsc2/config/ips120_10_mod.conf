/* -*-C-*-
  $Id$

  This file contains configuration information for controlling the
  Oxford IPS 120-10 magnet power supply with an additional external
  voltage input for finer control of current output. This file will
  be included as a header file, so the syntax must be valid C and
  changes will only become visible after re-compilation of the module.
*/


/* Define the name that's going to be used for the device. It must be
   identical to the name used in the GPIB configuration file (usually
   /etc/gpib.conf). */

#define DEVICE_NAME     "IPS120_10_mod"


/* Define the generic type of the device */

#define DEVICE_TYPE     "magnet power supply"


/* Maximum and minimum current (in A) that can be uses with the magnet
   the power supply is connected to (these are only used when they are
   not larger than the "safe" current limits). Note that the "maximum
   current" is not the maximum rated current but a bit lower for security
   reasons. */

#define MAX_CURRENT          100.0
#define MIN_CURRENT          0.0
#define CURRENT_RESOLUTION   1.0e-2

#define UPPER_LIMIT_CURRENT  120.0


/* Define the field-to-current conversion ratio (in G/A) - must be adjusted
   to fit a specific magnet! */

#define F2C_RATIO          416.67


/* Define the additional current resolution achieved by the external voltage
   input as the change in current through the magnet for 1 V (in A/V) -
   in the current setup a voltage of +/- 10 V will change the current by
   +/- 0.5 % of the maximum rated current of the power supply */

#define C2V_RATIO         ( 5.0e-4 * UPPER_LIMIT_CURRENT )

/* Maximum and minimum sweep speed (in A/s). */

#define MAX_SWEEP_RATE            ( 240.0 / 60.0 )
#define MIN_SWEEP_RATE            ( 1.0e-2 / 60.0 )


/* Sweep rate to be used when trying to go to a certain current value
   (this is the "Save Current Rate" for the magnet) */

#define FAST_SWEEP_RATE           ( 1.39 / 60.0 )


/* Define the name of the RB8510 DAC to be used for the additional
   external voltage input and its voltage resolution */

#define DAC_NAME          "RB8510_0"
#define DAC_RESOLUTION    5.0e-3

#define DAC_CURRENT_RESOLUTION  ( C2V_RATIO * DAC_RESOLUTION )
